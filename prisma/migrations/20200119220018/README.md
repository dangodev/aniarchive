# Migration `20200119220018`

This migration has been generated by Drew Powers at 1/19/2020, 10:00:18 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "aniarchive-v1"."FrameSequence" ADD COLUMN "image" text  NOT NULL  REFERENCES "aniarchive-v1"."Image"("id") ON DELETE RESTRICT;

DROP TABLE "aniarchive-v1"."Frame";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200112112437..20200119220018
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
 }
 enum Country {
   AU
@@ -27,17 +27,17 @@
 model Film {
   ///comment A unique ID for this film
   id             String          @id
   ///comment Animators for this film
-  animators      Person[]        @relation(name: "FilmAnimators")
+  animators      Person[]        @relation(name: "FilmAnimators", onDelete: CASCADE)
   ///comment The composers of the film
-  composers      Person[]        @relation(name: "FilmComposers")
+  composers      Person[]        @relation(name: "FilmComposers", onDelete: CASCADE)
   ///comment The directors of the film
-  directors      Person[]        @relation(name: "FilmDirectors")
+  directors      Person[]        @relation(name: "FilmDirectors", onDelete: CASCADE)
   ///comment Animation frame sequences for the film
   frameSequences FrameSequence[]
   ///comment Main image for the film
-  image          Image
+  image          Image           @relation(name: "FilmImage", onDelete: CASCADE)
   ///comment Releases of the film
   releases       Release[]
   ///comment Initial release year of the film
   releaseYear    Int
@@ -52,25 +52,16 @@
 }
 model FrameSequence {
   id      String   @default(cuid()) @id
-  artists Person[] @relation(name: "FrameSequenceArtists")
+  artists Person[] @relation(name: "FrameSequenceArtists", onDelete: CASCADE)
   film    Film
-  frames  Frame[]
+  image   Image    @relation(name: "FrameSequenceImage", onDelete: CASCADE)
   notes   String
   order   Int
   video   String
 }
-model Frame {
-  id       String  @default(cuid()) @id
-  artist   Person
-  image    Image
-  keyframe Boolean
-  notes    String
-  order    Int
-}
-
 model Image {
   id        String  @default(cuid()) @id
   copyright String?
   name      String
@@ -82,9 +73,9 @@
   id          String   @id
   ///comment Alias, usually if a person is better known by this
   alias       String?
   ///comment Films this person animated
-  animated    Film[]   @relation(name: "FilmArtists")
+  animated    Film[]   @relation(name: "FilmArtists", onDelete: CASCADE)
   ///comment Birthdays are split into day/month/year separately because we may not know all parts!
   birthMonth  Int?
   ///comment Birthdays are split into day/month/year separately because we may not know all parts!
   birthDay    Int?
@@ -92,11 +83,11 @@
   birthYear   Int?
   ///comment Country this person is associated with
   country     Country
   ///comment Films this person composed the music for
-  composed    Film[]   @relation(name: "FilmComposers")
+  composed    Film[]   @relation(name: "FilmComposers", onDelete: CASCADE)
   ///comment Films this person directed
-  directed    Film[]   @relation(name: "FilmDirectors")
+  directed    Film[]   @relation(name: "FilmDirectors", onDelete: CASCADE)
   ///comment Death days are split into day/month/year separately because we may not know all parts!
   deathDay    Int?
   ///comment Death days are split into day/month/year separately because we may not know all parts!
   deathMonth  Int?
@@ -105,11 +96,11 @@
   ///comment A short bio for this person
   description String?
   ///comment First name of this person
   firstName   String
-  founded     Studio[] @relation(name: "StudioFounders")
+  founded     Studio[] @relation(name: "StudioFounders", onDelete: CASCADE)
   ///comment Image of this person
-  image       Image?
+  image       Image?   @relation(name: "PersonImage", onDelete: CASCADE)
   ///comment This personâ€™s name in Kanji (Japanese only)
   kanji       String?
   ///comment Last name of this person
   lastName    String
@@ -121,9 +112,9 @@
   id           String  @default(cuid()) @id
   country      Country
   film         Film
   format       String
-  images       Image[]
+  images       Image[] @relation(name: "ReleaseImages", onDelete: CASCADE)
   notes        String?
   region       String
   releaseDay   Int?
   releaseMonth Int?
@@ -136,8 +127,8 @@
   city        String?
   country     Country
   films       Film[]
   foundedYear Int
-  founders    Person[] @relation(name: "StudioFounders")
-  image       Image?
+  founders    Person[] @relation(name: "StudioFounders", onDelete: CASCADE)
+  image       Image?   @relation(name: "StudioImage", onDelete: CASCADE)
   name        String   @unique
 }
```


