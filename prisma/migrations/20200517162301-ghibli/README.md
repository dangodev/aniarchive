# Migration `20200517162301-ghibli`

This migration has been generated by Drew Powers at 5/17/2020, 4:23:01 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."Film" (
"id" TEXT NOT NULL  ,"imageId" TEXT NOT NULL  ,"releaseYear" INTEGER NOT NULL  ,"studioId" TEXT   ,"title" TEXT NOT NULL  ,"titleEN" TEXT NOT NULL  ,"titleJP" TEXT NOT NULL  ,"trailer" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("imageId") REFERENCES "Image"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("studioId") REFERENCES "Studio"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."AnimationSequence" (
"filmId" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"imageId" TEXT NOT NULL  ,"notes" TEXT   ,"timestampEnd" INTEGER   ,"timestampStart" INTEGER   ,"url" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("filmId") REFERENCES "Film"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("imageId") REFERENCES "Image"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Image" (
"copyright" TEXT   ,"id" TEXT NOT NULL  ,"releaseId" TEXT   ,"title" TEXT NOT NULL  ,"url" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("releaseId") REFERENCES "Release"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Person" (
"alias" TEXT   ,"birthDay" INTEGER   ,"birthMonth" INTEGER   ,"birthYear" INTEGER   ,"country" TEXT NOT NULL  ,"deathDay" INTEGER   ,"deathMonth" INTEGER   ,"deathYear" INTEGER   ,"description" TEXT   ,"firstName" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"imageId" TEXT   ,"kanji" TEXT   ,"lastName" TEXT NOT NULL  ,"website" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("imageId") REFERENCES "Image"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."Release" (
"country" TEXT NOT NULL  ,"filmId" TEXT NOT NULL  ,"format" TEXT NOT NULL  ,"id" TEXT NOT NULL  ,"notes" TEXT   ,"releaseDay" INTEGER   ,"releaseMonth" INTEGER   ,"releaseYear" INTEGER NOT NULL  ,"runtime" INTEGER NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("filmId") REFERENCES "Film"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Studio" (
"city" TEXT   ,"country" TEXT NOT NULL  ,"foundedYear" INTEGER NOT NULL  ,"id" TEXT NOT NULL  ,"imageId" TEXT   ,"name" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("imageId") REFERENCES "Image"("id") ON DELETE SET NULL ON UPDATE CASCADE)

CREATE TABLE "quaint"."_FilmComposers" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Film"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Person"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_FilmDirectors" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Film"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Person"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_FilmWriters" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Film"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Person"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_AnimationSequenceToPerson" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "AnimationSequence"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Person"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_PersonToStudio" (
"A" TEXT NOT NULL  ,"B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Person"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Studio"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE UNIQUE INDEX "quaint"."Film.title" ON "Film"("title")

CREATE UNIQUE INDEX "quaint"."Film.titleJP" ON "Film"("titleJP")

CREATE UNIQUE INDEX "quaint"."Film.titleEN" ON "Film"("titleEN")

CREATE UNIQUE INDEX "quaint"."Image.url" ON "Image"("url")

CREATE UNIQUE INDEX "quaint"."Studio.name" ON "Studio"("name")

CREATE UNIQUE INDEX "quaint"."_FilmComposers_AB_unique" ON "_FilmComposers"("A","B")

CREATE  INDEX "quaint"."_FilmComposers_B_index" ON "_FilmComposers"("B")

CREATE UNIQUE INDEX "quaint"."_FilmDirectors_AB_unique" ON "_FilmDirectors"("A","B")

CREATE  INDEX "quaint"."_FilmDirectors_B_index" ON "_FilmDirectors"("B")

CREATE UNIQUE INDEX "quaint"."_FilmWriters_AB_unique" ON "_FilmWriters"("A","B")

CREATE  INDEX "quaint"."_FilmWriters_B_index" ON "_FilmWriters"("B")

CREATE UNIQUE INDEX "quaint"."_AnimationSequenceToPerson_AB_unique" ON "_AnimationSequenceToPerson"("A","B")

CREATE  INDEX "quaint"."_AnimationSequenceToPerson_B_index" ON "_AnimationSequenceToPerson"("B")

CREATE UNIQUE INDEX "quaint"."_PersonToStudio_AB_unique" ON "_PersonToStudio"("A","B")

CREATE  INDEX "quaint"."_PersonToStudio_B_index" ON "_PersonToStudio"("B")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200517162301-ghibli
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,136 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:./aniarchive.db"
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
+
+model Film {
+  // /comment A unique ID for this film
+  id                 String              @id
+  // /comment Title of the film in the original language
+  title              String              @unique
+  // /comment Japanese title
+  titleJP            String              @unique
+  // /comment English title
+  titleEN            String              @unique
+  // /comment Initial release year of the film
+  releaseYear        Int
+  // /comment Main image for the film
+  image              Image               @relation(fields: [imageId], references: [id])
+  imageId            String
+  // /comment Releases of the film
+  releases           Release[]
+  // /comment Studio that produced the film
+  studio             Studio?             @relation(fields: [studioId], references: [id])
+  studioId           String?
+  // /comment URL to watch the trailer
+  trailer            String?
+  // /comment Animation sequences for the film
+  animationSequences AnimationSequence[]
+  // /comment The composers of the film
+  composers          Person[]            @relation("FilmComposers", references: [id])
+  // /comment The directors of the film
+  directors          Person[]            @relation("FilmDirectors", references: [id])
+  // /comment The writers of the film
+  writers            Person[]            @relation("FilmWriters", references: [id])
+}
+
+model AnimationSequence {
+  id             String   @default(cuid()) @id
+  artists        Person[] @relation(references: [id])
+  film           Film     @relation(fields: [filmId], references: [id])
+  filmId         String
+  image          Image    @relation(fields: [imageId], references: [id])
+  imageId        String
+  notes          String?
+  timestampStart Int?
+  timestampEnd   Int?
+  url            String
+}
+
+model Image {
+  id                String              @default(cuid()) @id
+  copyright         String?
+  title             String
+  url               String              @unique
+  releaseId         String?
+  Film              Film[]
+  AnimationSequence AnimationSequence[]
+  Person            Person[]
+  Release           Release?            @relation("ReleaseImages", fields: [releaseId], references: [id])
+  Studio            Studio[]
+}
+
+model Person {
+  // /comment A unique ID for this person
+  id          String              @id
+  // /comment Last name of this person
+  lastName    String
+  // /comment First name of this person
+  firstName   String
+  // /comment This personâ€™s name in Kanji (Japanese only)
+  kanji       String?
+  // /comment Alias, usually if a person is better known by this
+  alias       String?
+  // /comment Image of this person
+  image       Image?              @relation(fields: [imageId], references: [id])
+  imageId     String?
+  // /comment A short bio for this person
+  description String?
+  // /comment Country this person is associated with
+  country     String
+  // /comment Birthdays are split into day/month/year separately because we may not know all parts!
+  birthYear   Int?
+  // /comment Birthdays are split into day/month/year separately because we may not know all parts!
+  birthMonth  Int?
+  // /comment Birthdays are split into day/month/year separately because we may not know all parts!
+  birthDay    Int?
+  // /comment Death days are split into day/month/year separately because we may not know all parts!
+  deathYear   Int?
+  // /comment Death days are split into day/month/year separately because we may not know all parts!
+  deathMonth  Int?
+  // /comment Death days are split into day/month/year separately because we may not know all parts!
+  deathDay    Int?
+  // /comment Website of this person
+  website     String?
+  // /comment Films this person animated
+  animated    AnimationSequence[] @relation(references: [id])
+  // /comment Films this person directed
+  directed    Film[]              @relation("FilmDirectors", references: [id])
+  // /comment Films this person wrote
+  wrote       Film[]              @relation("FilmWriters", references: [id])
+  // /comment Films this person composed the music for
+  composed    Film[]              @relation("FilmComposers", references: [id])
+  // /comment Studios this person founded
+  founded     Studio[]            @relation(references: [id])
+}
+
+model Release {
+  id           String  @default(cuid()) @id
+  film         Film    @relation(fields: [filmId], references: [id])
+  filmId       String
+  images       Image[] @relation("ReleaseImages")
+  releaseYear  Int
+  releaseMonth Int?
+  releaseDay   Int?
+  country      String
+  // /comment Format for the release (e.g. DVD / BluRay / Television)
+  format       String
+  notes        String?
+  runtime      Int
+}
+
+model Studio {
+  id          String   @id
+  name        String   @unique
+  image       Image?   @relation(fields: [imageId], references: [id])
+  imageId     String?
+  foundedYear Int
+  films       Film[]
+  city        String?
+  country     String
+  founders    Person[] @relation(references: [id])
+}
```


